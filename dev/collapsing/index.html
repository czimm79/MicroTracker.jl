<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Collapsing · MicroTracker.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://czimm79.github.io/MicroTracker.jl/collapsing/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MicroTracker.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MicroTracker.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../settingupuser/">Setting Up</a></li><li><a class="tocitem" href="../pluto/">Pluto</a></li><li><a class="tocitem" href="../linking/">Linking</a></li><li class="is-active"><a class="tocitem" href>Collapsing</a><ul class="internal"><li><a class="tocitem" href="#Collapse-data"><span>Collapse data</span></a></li><li><a class="tocitem" href="#Filtering-based-on-collapsed-data"><span>Filtering based on collapsed data</span></a></li></ul></li><li><a class="tocitem" href="../experimental/">Experimental</a></li><li><a class="tocitem" href="../segmenting/">Segmentation</a></li></ul></li><li><span class="tocitem">Contributing</span><ul><li><a class="tocitem" href="../settingupdev/">Setting Up (for beginners)</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Collapsing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Collapsing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/czimm79/MicroTracker.jl/blob/master/docs/src/collapsing.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Collapsing"><a class="docs-heading-anchor" href="#Collapsing">Collapsing</a><a id="Collapsing-1"></a><a class="docs-heading-anchor-permalink" href="#Collapsing" title="Permalink"></a></h1><p>On this page, you&#39;ll process the time-series <code>linked_data</code> into <code>collapsed_data</code> which summarizes each microbot into a single row.</p><h2 id="Collapse-data"><a class="docs-heading-anchor" href="#Collapse-data">Collapse data</a><a id="Collapse-data-1"></a><a class="docs-heading-anchor-permalink" href="#Collapse-data" title="Permalink"></a></h2><p>The convenient function <a href="../api/#MicroTracker.collapse_data-Tuple{AbstractDataFrame}"><code>collapse_data</code></a> calculates the most common metrics used from the metrics calculated from ImageJ <a href="../segmenting/#Segmentation">Segmentation</a>. To see the source code, click on the link to the function and click the blue &quot;source&quot; button to see exactly how they are calculated.</p><pre><code class="language-julia-repl hljs">julia&gt; collapsed_data = collapse_data(linked_data)
37×11 DataFrame
 Row │ particle_unique  filename      FPS      V          Vx           Vy           Area_um_mean  Ω_est       R        ⋯
     │ String15         String15      Float64  Float64    Float64      Float64      Float64       Float64     Float64  ⋯
─────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │ 5_13p5_61p35-0   5_13p5_61p35    61.35  88.7683    73.1812      -0.533202       524.844     0.0866525  30.1871  ⋯
   2 │ 5_13p5_61p35-1   5_13p5_61p35    61.35  84.2168    75.1932      -1.43098        723.553     0.184789   39.8465
   3 │ 5_13p5_61p35-2   5_13p5_61p35    61.35  34.589     25.285        3.95886         66.7345    4.94208    12.4914
   4 │ 5_13p5_61p35-3   5_13p5_61p35    61.35  61.7119    51.8247      -3.01578         80.8338    5.06137    15.06
   5 │ 5_13p5_61p35-4   5_13p5_61p35    61.35  20.6538     7.68584      0.0244971       23.9995    2.51434     2.98598 ⋯
   6 │ 5_13p5_61p35-5   5_13p5_61p35    61.35  21.9972     7.1295      -0.320993        24.6687    2.48485     3.94248
   7 │ 5_13p5_61p35-6   5_13p5_61p35    61.35  22.2261     6.78449     -0.353836        24.5469    2.47104     3.94248
   8 │ 5_13p5_61p35-7   5_13p5_61p35    61.35  22.2123     6.55907      0.46061         24.4111    2.46496     3.94248
   9 │ 5_13p5_61p35-8   5_13p5_61p35    61.35  33.6507    25.6817      -3.06842         43.5993    4.94208     7.46025 ⋯
  10 │ 5_13p5_61p35-9   5_13p5_61p35    61.35   1.99297   -0.3504       0.0640706        7.94797   2.30063     1.84555
  11 │ 5_13p5_61p35-10  5_13p5_61p35    61.35  12.4556     2.40331     -0.227096        17.7137    2.55625     3.02833
  ⋮  │        ⋮              ⋮           ⋮         ⋮           ⋮            ⋮            ⋮            ⋮          ⋮     ⋱
  28 │ 5_8p4_28p68-6    5_8p4_28p68     28.68  47.4422    24.4107      38.7753         100.05      5.28316    17.4016
  29 │ 5_8p4_28p68-7    5_8p4_28p68     28.68  48.9004    24.822       39.8771         113.075     5.28316    19.7883  ⋯
  30 │ 5_8p4_28p68-8    5_8p4_28p68     28.68  37.2317    16.4921      30.9989          84.275     5.28316    15.0636
  31 │ 5_8p4_28p68-9    5_8p4_28p68     28.68  40.4129    15.381       35.4248          85.391     5.28316    14.8954
  32 │ 5_8p4_28p68-10   5_8p4_28p68     28.68  40.729     20.3822      33.0557         566.571     1.88684    26.7924
  33 │ 5_8p4_28p68-11   5_8p4_28p68     28.68  41.6894    18.5982      35.8152         707.16      1.50947    28.3004  ⋯
  34 │ 5_8p4_28p68-12   5_8p4_28p68     28.68   0.700078  -0.0662316   -0.00804089      21.3812    2.64158     2.95058
  35 │ 5_8p4_28p68-13   5_8p4_28p68     28.68  39.0276    18.1646      31.7101         660.916     1.50947    28.8319
  36 │ 5_8p4_28p68-14   5_8p4_28p68     28.68  12.5579    -0.761769     0.545299        15.3284    0.377368    2.91731
  37 │ 5_8p4_28p68-15   5_8p4_28p68     28.68  47.225     17.9276      40.9265         152.034     5.28316    19.8286  ⋯
                                                                                           2 columns and 16 rows omitted

julia&gt; names(collapsed_data)
11-element Vector{String}:
 &quot;particle_unique&quot;
 &quot;filename&quot;
 &quot;FPS&quot;
 &quot;V&quot;
 &quot;Vx&quot;
 &quot;Vy&quot;
 &quot;Area_um_mean&quot;
 &quot;Ω_est&quot;
 &quot;R&quot;
 &quot;Circularity&quot;
 &quot;total_displacement_um&quot;</code></pre><ul><li><code>V</code> : The mean of the instantaneous speed, <code>dp_um</code>. Always positive, as it is a magnitude. Units of µm/s.</li><li><code>Vx</code> : The mean of the numerical derivative of the x-position. Can be positive or negative. Units of µm/s.</li><li><code>Vy</code> : The mean of the numerical derivative of the y-position. Can be positive or negative. Units of µm/s.</li><li><code>Area_um_mean</code> : The mean of the area of the microbot. Units of µm^2.</li><li><code>Ω_est</code> : The estimated rotation rate extracted from the FFT of the <code>Major_um</code> column in the linked data. Performed using the <a href="../api/#MicroTracker.estimate_omega-Tuple{AbstractVector, AbstractVector}"><code>estimate_omega</code></a> function. Units of Hz.</li><li><code>R</code> : The bounding-circle radius/radius of gyration. Calculated as the 95th percentile of the major axis <code>Major_um</code> divided by 2. Units of µm.</li><li><code>Circularity</code> : A quantifier based on the aspect ratio of the fit ellipse. Calculated from ImageJ. See <a href="https://imagej.nih.gov/ij/docs/menus/analyze.html">their docs</a>. Unitless.</li><li><code>total_displacement_um</code> : The total displacement of the microbot over its <em>entire trajectory</em>. This is already constant in <code>linked_data</code>, so just take one of the values. Units of µm.</li></ul><h2 id="Filtering-based-on-collapsed-data"><a class="docs-heading-anchor" href="#Filtering-based-on-collapsed-data">Filtering based on collapsed data</a><a id="Filtering-based-on-collapsed-data-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering-based-on-collapsed-data" title="Permalink"></a></h2><p>After collapsing the data, its common to filter out microbots that may be too small or large, going too slow, or stuck to the substrate. This can be performed using the <a href="#MicroTracker.filter_trajectories"><code>filter_trajectories</code></a> function.</p><article class="docstring"><header><a class="docstring-binding" id="MicroTracker.filter_trajectories" href="#MicroTracker.filter_trajectories"><code>MicroTracker.filter_trajectories</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">filter_trajectories(collapsed_data::AbstractDataFrame, filter_settings::NamedTuple)</code></pre><p>Filter out microbots that may be too small or large, going too slow, or stuck to the substrate.</p><p>The <code>filter_settings</code> is a <code>NamedTuple</code> with the following fields:</p><ul><li><code>MIN_VELOCITY</code> : minimum velocity in um/s</li><li><code>MIN_BOUNDING_RADIUS</code> : minimum bounding radius in um</li><li><code>MAX_BOUNDING_RADIUS</code> : maximum bounding radius in um</li><li><code>MIN_DISPLACEMENT</code> : minimum total displacement in um</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">filter_settings = (
    MIN_VELOCITY = 10.0,  # um / s  
    MIN_BOUNDING_RADIUS = 3.38,  # um
    MAX_BOUNDING_RADIUS = 75,  # µm
    MIN_DISPLACEMENT = 0,  # µm
)

filtered_collapsed_data = filter_trajectories(collapsed_data, filter_settings)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/czimm79/MicroTracker.jl/blob/accd995c0e5661a8d751500fb099305200902090/src/collapsed_data.jl#L40-L62">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linking/">« Linking</a><a class="docs-footer-nextpage" href="../experimental/">Experimental »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 4 July 2023 20:06">Tuesday 4 July 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
